<!DOCTYPE html>
<html style="width:100%;height:100%;background-color:black;">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />
  <meta name="description" content="HZ OneBlock Optimized Client" />
  <meta name="keywords" content="eaglercraft, minecraft, oneblock, fps, optimized" />
  <title>HZ OneBlock (Optimized)</title>
  <link type="image/png" rel="shortcut icon" href="favicon.png" />
  <script type="text/javascript" src="classes.js"></script>
</head>
<body style="margin:0;width:100%;height:100%;overflow:hidden;background-color:black;" id="game_frame">
  <script type="text/javascript">
    "use strict";
    window.addEventListener("load", function() {
      if(typeof window.eaglercraftXOpts === "undefined") window.eaglercraftXOpts = {};

      // Inject custom options
      Object.assign(window.eaglercraftXOpts, {
        demoMode: false,
        container: "game_frame",
        assetsURI: "assets.epk",
        localesURI: "lang/",
        worldsDB: "worlds",
        crashOnUncaughtExceptions: false,
        logInvalidCerts: false,
        maxParticles: 200,
        disableInstancedRendering: true,
        smoothGui: false,
        renderScale: 0.5,
        servers: [
          { addr: "ws://localhost:8081/", name: "Local Test Server" },
          { addr: "wss://hzblocky.loca.lt", name: "HZ OneBlock" }
        ]
      });

      // Run game
      if(typeof main === "function") {
        main();
        console.log("✅ Game started");
      } else {
        console.error("❌ main() not found in classes.js");
      }

      // FPS + stability patches
      let patchInterval = setInterval(() => {
        if(window.EaglercraftX && window.EaglercraftX.settings) {
          let s = window.EaglercraftX.settings;
          s.useFXAA = false;
          s.dynamicLights = false;
          s.renderDistance = 6;
          s.smoothLighting = false;
          s.clouds = false;
          s.particles = "minimal";
          s.graphics = "fast";
          s.entityShadows = false;
          s.mipmapLevels = 0;
          clearInterval(patchInterval);
          console.log("⚡ Graphics patched for FPS");
        }
      }, 2000);

      // Disable VSync
      setTimeout(() => {
        if(window.EaglercraftX && window.EaglercraftX.mainLoop) {
          let oldLoop = window.EaglercraftX.mainLoop;
          function noVsyncLoop() {
            oldLoop();
            setTimeout(noVsyncLoop, 0);
          }
          noVsyncLoop();
          console.log("⚡ VSync override enabled");
        }
      }, 3000);

      // Async chunk builder
      setTimeout(() => {
        if(window.EaglercraftX && window.EaglercraftX.chunkBuilder) {
          let oldBuild = window.EaglercraftX.chunkBuilder.buildNext;
          window.EaglercraftX.chunkBuilder.buildNext = function() {
            setTimeout(() => oldBuild.call(window.EaglercraftX.chunkBuilder), 1);
          };
          console.log("⚡ Async chunk builder enabled");
        }
      }, 5000);
    });
  </script>
</body>
</html>
